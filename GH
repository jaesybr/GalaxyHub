local UserInputService = game:GetService("UserInputService")
local CoreGui = gethui() or game:GetService("CoreGui")

if CoreGui:FindFirstChild("GalaxyHub_Project") then CoreGui:FindFirstChild("GalaxyHub_Project"):Destroy() end

local Library = {Visible = true}
local ScreenGui = Instance.new("ScreenGui", CoreGui)
ScreenGui.Name = "GalaxyHub_Project"

function Library:CreateWindow(Name, Size)
    local Window = {CurrentTab = nil}
    local MainSize = Size or Vector2.new(500, 500)
    
    local Main = Instance.new("Frame", ScreenGui)
    Main.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    Main.Size = UDim2.fromOffset(MainSize.X, MainSize.Y)
    Main.Position = UDim2.new(0.5, -MainSize.X/2, 0.5, -MainSize.Y/2)
    Instance.new("UIStroke", Main).Color = Color3.fromRGB(45, 45, 45)

    local TopBar = Instance.new("Frame", Main)
    TopBar.Size = UDim2.new(1, 0, 0, 30)
    TopBar.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
    
    local Title = Instance.new("TextLabel", TopBar)
    Title.Size = UDim2.new(1, 0, 1, 0); Title.Text = Name; Title.TextColor3 = Color3.fromRGB(255, 255, 255); Title.BackgroundTransparency = 1; Title.Font = Enum.Font.Code

    local TabHolder = Instance.new("Frame", Main)
    TabHolder.Position = UDim2.fromOffset(0, 30); TabHolder.Size = UDim2.new(1, 0, 0, 30); TabHolder.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    local TabList = Instance.new("UIListLayout", TabHolder); TabList.FillDirection = Enum.FillDirection.Horizontal

    local Container = Instance.new("Frame", Main)
    Container.Position = UDim2.fromOffset(0, 60); Container.Size = UDim2.new(1, 0, 1, -60); Container.BackgroundTransparency = 1

    function Window:CreateTab(TabName)
        local Tab = {}
        local TBtn = Instance.new("TextButton", TabHolder)
        TBtn.Size = UDim2.new(0, 100, 1, 0); TBtn.Text = TabName; TBtn.BackgroundColor3 = Color3.fromRGB(30, 30, 30); TBtn.TextColor3 = Color3.fromRGB(255, 255, 255)

        local Page = Instance.new("ScrollingFrame", Container)
        Page.Size = UDim2.new(1, 0, 1, 0); Page.BackgroundTransparency = 1; Page.Visible = false; Page.CanvasSize = UDim2.new(0,0,5,0)
        Instance.new("UIListLayout", Page).Padding = UDim.new(0, 5)

        TBtn.MouseButton1Click:Connect(function()
            for _, v in pairs(Container:GetChildren()) do v.Visible = false end
            Page.Visible = true
        end)

        function Tab:AddGroupBox(GName)
            local Group = {}
            local Box = Instance.new("Frame", Page)
            Box.Size = UDim2.new(1, -10, 0, 100); Box.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
            Instance.new("UIListLayout", Box).Padding = UDim.new(0, 5)
            
            local L = Instance.new("TextLabel", Box)
            L.Size = UDim2.new(1, 0, 0, 20); L.Text = GName; L.BackgroundColor3 = Color3.fromRGB(120, 80, 255)

            function Group:AddButton(BName, Callback)
                local B = Instance.new("TextButton", Box)
                B.Size = UDim2.new(1, 0, 0, 30); B.Text = BName; B.BackgroundColor3 = Color3.fromRGB(50, 50, 50); B.TextColor3 = Color3.fromRGB(255, 255, 255)
                B.MouseButton1Click:Connect(Callback)
            end
            return Group
        end
        
        -- Force the first tab created to be visible immediately
        if Window.CurrentTab == nil then
            Window.CurrentTab = Tab
            Page.Visible = true
        end
        
        return Tab
    end
    return Window
end
return Library
