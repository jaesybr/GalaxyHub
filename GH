local UserInputService = game:GetService("UserInputService")
local CoreGui = gethui() or game:GetService("CoreGui")

if CoreGui:FindFirstChild("GalaxyHub_Project") then CoreGui:FindFirstChild("GalaxyHub_Project"):Destroy() end

local Library = {
    Visible = true, 
    Flags = {}, 
    ToggleKey = Enum.KeyCode.RightShift,
    Theme = {
        MainColor = Color3.fromRGB(15, 15, 15),
        AccentColor = Color3.fromRGB(120, 80, 255),
        OutlineColor = Color3.fromRGB(35, 35, 35),
        FontColor = Color3.fromRGB(255, 255, 255),
        Font = Enum.Font.Code,
    }
}

local ScreenGui = Instance.new("ScreenGui", CoreGui)
ScreenGui.Name = "GalaxyHub_Project"

local function MakeDraggable(topBar, mainFrame)
    local dragging, dragInput, dragStart, startPos
    topBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true; dragStart = input.Position; startPos = mainFrame.Position
        end
    end)
    UserInputService.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = input.Position - dragStart
            mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then dragging = false end
    end)
end

function Library:CreateWindow(Name, Size)
    local Window = { CurrentTab = nil }
    local XSize = Size and Size.X or 550
    local YSize = Size and Size.Y or 480
    
    local MainFrame = Instance.new("Frame", ScreenGui)
    MainFrame.Size = UDim2.fromOffset(XSize, YSize)
    MainFrame.Position = UDim2.new(0.5, -(XSize/2), 0.5, -(YSize/2))
    MainFrame.BackgroundColor3 = Library.Theme.MainColor
    Instance.new("UIStroke", MainFrame).Color = Library.Theme.OutlineColor

    local Header = Instance.new("Frame", MainFrame)
    Header.Size = UDim2.new(1, 0, 0, 30); Header.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
    local Title = Instance.new("TextLabel", Header)
    Title.Size = UDim2.new(1, 0, 1, 0); Title.Text = "  " .. Name; Title.TextColor3 = Library.Theme.FontColor; Title.Font = Library.Theme.Font; Title.BackgroundTransparency = 1; Title.TextSize = 14; Title.TextXAlignment = Enum.TextXAlignment.Left
    MakeDraggable(Header, MainFrame)

    local TabBar = Instance.new("Frame", MainFrame)
    TabBar.Size = UDim2.new(1, -20, 0, 30); TabBar.Position = UDim2.fromOffset(10, 35); TabBar.BackgroundTransparency = 1
    Instance.new("UIListLayout", TabBar).FillDirection = Enum.FillDirection.Horizontal; TabBar.UIListLayout.Padding = UDim.new(0, 5)

    local Container = Instance.new("Frame", MainFrame)
    Container.Size = UDim2.new(1, -20, 1, -85); Container.Position = UDim2.fromOffset(10, 75); Container.BackgroundTransparency = 1

    function Window:CreateTab(TabName)
        local Tab = {}
        local TabBtn = Instance.new("TextButton", TabBar)
        TabBtn.Size = UDim2.new(0, 100, 1, 0); TabBtn.BackgroundColor3 = Color3.fromRGB(20, 20, 20); TabBtn.Text = TabName; TabBtn.TextColor3 = Color3.fromRGB(160, 160, 160); TabBtn.Font = Library.Theme.Font; TabBtn.TextSize = 13
        Instance.new("UIStroke", TabBtn).Color = Library.Theme.OutlineColor

        local Page = Instance.new("Frame", Container); Page.Size = UDim2.new(1, 0, 1, 0); Page.BackgroundTransparency = 1; Page.Visible = false
        local Left = Instance.new("ScrollingFrame", Page); Left.Size = UDim2.new(0.5, -5, 1, 0); Left.BackgroundTransparency = 1; Left.ScrollBarThickness = 0; Left.AutomaticCanvasSize = Enum.AutomaticSize.Y
        local Right = Instance.new("ScrollingFrame", Page); Right.Size = UDim2.new(0.5, -5, 1, 0); Right.Position = UDim2.new(0.5, 5, 0, 0); Right.BackgroundTransparency = 1; Right.ScrollBarThickness = 0; Right.AutomaticCanvasSize = Enum.AutomaticSize.Y
        Instance.new("UIListLayout", Left).Padding = UDim.new(0, 15); Instance.new("UIListLayout", Right).Padding = UDim.new(0, 15)

        function Tab:Select()
            if Window.CurrentTab then 
                Window.CurrentTab.Page.Visible = false
                Window.CurrentTab.Btn.TextColor3 = Color3.fromRGB(160, 160, 160) 
            end
            Page.Visible = true
            TabBtn.TextColor3 = Library.Theme.AccentColor
            Window.CurrentTab = {Page = Page, Btn = TabBtn}
        end
        TabBtn.MouseButton1Click:Connect(function() Tab:Select() end)

        function Tab:AddGroupBox(GName, Side)
            local Group = {}
            local ParentCol = (Side == "Right" and Right or Left)
            
            local Box = Instance.new("Frame", ParentCol)
            Box.Size = UDim2.new(1, 0, 0, 20); Box.AutomaticSize = Enum.AutomaticSize.Y
            Box.BackgroundColor3 = Library.Theme.MainColor; Instance.new("UIStroke", Box).Color = Library.Theme.OutlineColor
            
            local Content = Instance.new("Frame", Box)
            Content.Size = UDim2.new(1, 0, 1, 0); Content.BackgroundTransparency = 1
            Instance.new("UIPadding", Content).Padding = UDim.new(0, 12, 0, 12)
            Instance.new("UIListLayout", Content).Padding = UDim.new(0, 8)
            
            local L = Instance.new("TextLabel", Box)
            L.Text = " " .. GName .. " "; L.Position = UDim2.fromOffset(10, -8); L.BackgroundColor3 = Library.Theme.MainColor; L.TextColor3 = Library.Theme.FontColor; L.AutomaticSize = Enum.AutomaticSize.X; L.Font = Library.Theme.Font; L.TextSize = 12

            function Group:AddButton(BName, Callback)
                local B = Instance.new("TextButton", Content)
                B.Size = UDim2.new(1, 0, 0, 22); B.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
                B.Text = BName; B.TextColor3 = Library.Theme.FontColor; B.Font = Library.Theme.Font; B.TextSize = 12
                Instance.new("UIStroke", B).Color = Library.Theme.OutlineColor
                B.MouseButton1Click:Connect(Callback)
            end

            return Group
        end
        return Tab
    end
    return Window
end

return Library
